{"version":3,"sources":["Popover.tsx"],"names":["Popover","React","forwardRef","animated","animationType","backgroundColor","caret","withCaret","caretPosition","children","forceInitialAnimation","numberOfLines","visible","position","style","extraProps","ref","isContentString","isHorizontalLayout","prevVisible","opacity","Animated","Value","current","animation","toValue","duration","ANIMATION_DURATION","useNativeDriver","start","stop","styles","animationTranslation","translateX","interpolate","inputRange","outputRange","translateY","container","transform","containerHorizontal","content","contentTextOnly","contentText","StyleSheet","create","width","POPOVER_WIDTH","overflow","flexDirection","flex","zIndex","POPOVER_BACKGROUND_COLOR","borderRadius","BORDER_RADIUS","padding","POPOVER_PADDING","color","POPOVER_FONT_COLOR","fontSize","POPOVER_FONT_SIZE","fontWeight","textAlign"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef } from 'react';\nimport { Animated, StyleSheet, Text, View, ViewProps } from 'react-native';\nimport Caret from './Caret';\nimport { ANIMATION_DURATION } from './constants';\nimport {\n  POPOVER_BACKGROUND_COLOR,\n  BORDER_RADIUS,\n  POPOVER_FONT_COLOR,\n  POPOVER_FONT_SIZE,\n  POPOVER_PADDING,\n  POPOVER_WIDTH,\n} from './style-guide';\n\nexport type PopoverProps = {\n  animated?: boolean;\n  animationType?: 'spring' | 'timing';\n  backgroundColor?: string;\n  caret?: boolean;\n  caretPosition?: 'left' | 'center' | 'right';\n  children: string | React.ReactElement;\n  forceInitialAnimation?: boolean;\n  numberOfLines?: number;\n  visible?: boolean;\n  position?: 'top' | 'right' | 'bottom' | 'left';\n} & ViewProps;\n\nconst Popover = React.forwardRef<View, PopoverProps>(function Popover(\n  {\n    animated = true,\n    animationType = 'timing',\n    backgroundColor,\n    caret: withCaret = true,\n    caretPosition = 'center',\n    children,\n    forceInitialAnimation = false,\n    numberOfLines,\n    visible = true,\n    position = 'bottom',\n    style,\n    ...extraProps\n  },\n  ref\n) {\n  const isContentString = typeof children === 'string';\n  const isHorizontalLayout = position === 'left' || position === 'right';\n  const prevVisible = useRef(visible);\n  const opacity = useRef(\n    new Animated.Value(\n      visible ? (forceInitialAnimation ? 0 : 1) : forceInitialAnimation ? 1 : 0\n    )\n  ).current;\n\n  useEffect(\n    () => {\n      let animation: Animated.CompositeAnimation | undefined;\n\n      if (animated) {\n        if (visible && (!prevVisible.current || forceInitialAnimation)) {\n          animation = Animated[animationType](opacity, {\n            toValue: 1,\n            duration: ANIMATION_DURATION,\n            useNativeDriver: true,\n          });\n        } else if (!visible && (prevVisible.current || forceInitialAnimation)) {\n          animation = Animated[animationType](opacity, {\n            toValue: 0,\n            duration: ANIMATION_DURATION,\n            useNativeDriver: true,\n          });\n        }\n\n        animation?.start();\n      }\n\n      prevVisible.current = visible;\n\n      return () => animation?.stop();\n    },\n    [visible] // eslint-disable-line react-hooks/exhaustive-deps\n  );\n\n  const caret = (\n    <Caret\n      align={caretPosition}\n      position={position}\n      backgroundColor={backgroundColor}\n      style={styles.caret}\n    />\n  );\n\n  let animationTranslation: any;\n\n  if (isHorizontalLayout) {\n    animationTranslation = {\n      translateX: opacity.interpolate({\n        inputRange: [0, 1],\n        outputRange: position === 'left' ? [5, 0] : [-5, 0],\n      }),\n    };\n  } else {\n    animationTranslation = {\n      translateY: opacity.interpolate({\n        inputRange: [0, 1],\n        outputRange: position === 'top' ? [5, 0] : [-5, 0],\n      }),\n    };\n  }\n\n  return (\n    <View\n      ref={ref}\n      style={[styles.container, style]}\n      pointerEvents={visible ? 'auto' : 'none'}\n      {...extraProps}\n    >\n      <Animated.View\n        style={[\n          { opacity, transform: [animationTranslation] },\n          isHorizontalLayout && styles.containerHorizontal,\n        ]}\n      >\n        {withCaret && (position === 'bottom' || position === 'right') && caret}\n\n        <View\n          style={[\n            styles.content,\n            isContentString && styles.contentTextOnly,\n            !!backgroundColor && { backgroundColor },\n          ]}\n        >\n          {isContentString ? (\n            <Text numberOfLines={numberOfLines} style={styles.contentText}>\n              {children}\n            </Text>\n          ) : (\n            children\n          )}\n        </View>\n\n        {withCaret && (position === 'top' || position === 'left') && caret}\n      </Animated.View>\n    </View>\n  );\n});\n\nconst styles = StyleSheet.create({\n  container: {\n    width: POPOVER_WIDTH,\n    overflow: 'hidden',\n  },\n  containerHorizontal: {\n    flexDirection: 'row',\n  },\n  content: {\n    flex: 1,\n    zIndex: 1,\n    backgroundColor: POPOVER_BACKGROUND_COLOR,\n    borderRadius: BORDER_RADIUS * 2,\n    overflow: 'hidden',\n  },\n  contentTextOnly: {\n    padding: POPOVER_PADDING,\n  },\n  contentText: {\n    color: POPOVER_FONT_COLOR,\n    fontSize: POPOVER_FONT_SIZE,\n    fontWeight: 'bold',\n    textAlign: 'center',\n  },\n  caret: {\n    zIndex: 0,\n  },\n});\n\nexport default Popover;\n"]}